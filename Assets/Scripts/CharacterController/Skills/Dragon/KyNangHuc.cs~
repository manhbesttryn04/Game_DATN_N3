using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class KyNangHuc : PlayerLaze {

	public float forceAttack = 20f;
	private bool Cancel = false;

	private void HandlingAttackHuc ()
	{
		if (base.GetActive()) {
			// Code thuc hien
			PlayerHealth.control.SetMienKhang (true); // Tat hieu ung vi tat cong
			// Thuc hien bi day toi
			if (PlayerHealth.control.gameObject.transform.localScale.x < 0) {
				PlayerMoving.myBody.AddForce (new Vector2 (-forceAttack, 0f), ForceMode2D.Force);
			} else {
				PlayerMoving.myBody.AddForce (new Vector2 (forceAttack, 0f), ForceMode2D.Force);
			}
			// Khoa truc z,y
			PlayerMoving.myBody.constraints = RigidbodyConstraints2D.FreezePositionY | RigidbodyConstraints2D.FreezeRotation;
			// Hien cac hieu ung khac...
			Cancel = true;
			Invoke ("InvokeCancelAnimationChildren", base.timeCancel);
		}
		else {
			// Huy thuc hien tan cong
			InvokeCancelAnimationChildren ();
		}
	}

	// Update is called once per frame
	public void Update () {
		base.HandlingUpdate ();

		HandlingAttackHuc ();
	}

	private void InvokeCancelAnimationChildren(){
		// Khoa z
		PlayerMoving.myBody.constraints = RigidbodyConstraints2D.FreezeRotation;

		PlayerHealth.control.SetMienKhang (false); // Tat hieu ung vi tat cong
		if (Cancel) {
			Cancel = false;
			PlayerMoving.myBody.velocity = Vector2.zero;
			base.SetActive (false);
		}
		CancelInvoke ("InvokeCancelAnimationChildren");
	}
}
